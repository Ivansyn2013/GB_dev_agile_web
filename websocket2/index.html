<!DOCTYPE html>
<html>
<head>
    <title>Screen Capture Client</title>
</head>
<body>
    <h1>Screen Capture</h1>
    <img id="screenImage" src="" alt="Screen Capture" width="640px" height="480px">

    <script>
        // WebSocket URL (replace with your server's URL)
        const serverUrl = 'ws://localhost:8766';

        const screenImage = document.getElementById('screenImage');

        // Create a WebSocket connection to the server
        const socket = new WebSocket(serverUrl);

        // Handle messages received from the server
        socket.addEventListener('message', async (event) => {
            // Assuming the server sends binary data (screen capture frame)
            const frameData = event.data;

            // Create a Blob from the received frame data
            const blob = new Blob([frameData], { type: 'image/jpeg' }); // Adjust the type as needed

            // Create a data URL from the Blob
            const dataUrl = URL.createObjectURL(blob);

            // Display the captured frame in the <img> element
            screenImage.src = dataUrl;
        });

        // Handle errors
        socket.addEventListener('error', (event) => {
            console.error('WebSocket error:', event);
        });

        // Handle the WebSocket connection closing
        socket.addEventListener('close', (event) => {
            if (event.code === 1000) {
                console.log('WebSocket connection closed gracefully.');
            } else {
                console.error('WebSocket connection closed with code:', event.code);
            }
        });

        // Close the WebSocket connection when the page is unloaded
        window.addEventListener('beforeunload', () => {
            socket.close();
        });
    </script>
</body>
</html>
